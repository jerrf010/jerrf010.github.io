<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hey, Day -- Calendar</title>
    <link rel="icon" href="https://github.com/jerrf010/basic_html/blob/main/park_with_shades.png?raw=true"
        type="image/icon type">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Chewy&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Oswald:wght@200..700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="study-scheduler.js"></script>
    <style>
        /* Calendar Specific Styles - WIDER VERSION */
        .calendar-header {
            width: 100%;
            margin-bottom: 15px;
            position: relative;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-title {
            font-family: 'Chewy', cursive;
            font-size: 48px;
            color: #1a3c27;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 5px;
        }

        .calendar-subtitle {
            font-family: 'Nunito', sans-serif;
            font-size: 20px;
            color: #2d5a3d;
            font-weight: 600;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        /* Updated Date Navigation with Today Button */
        .date-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 15px 20px;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(34, 96, 78, 0.2);
            width: 500px;
        }

        .nav-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(34, 96, 78, 0.2);
            border-radius: 18px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #22604e;
            font-size: 24px;
            margin-left: 10px;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-3px);
            border-color: rgba(34, 96, 78, 0.4);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Today Button Styles */
        .today-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(34, 96, 78, 0.2);
            border-radius: 18px;
            padding: 0 20px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #22604e;
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            font-weight: 700;
            white-space: nowrap;
            margin-left: 10px;
            margin-right: 10px;
        }

        .today-btn:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-3px);
            border-color: rgba(34, 96, 78, 0.4);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .today-btn i {
            margin-right: 8px;
            font-size: 14px;
        }

        .current-month {
            font-family: 'Nunito', sans-serif;
            font-size: 28px;
            color: #1a3c27;
            font-weight: 700;
            text-align: center;
        }

        /* Calendar Grid - WIDER */
        .calendar-grid {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 30px;
            padding: 25px;
            margin-bottom: 20px;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            width: 480px;
        }

        .days-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            margin-bottom: 20px;
            text-align: center;
            gap: 5px;
        }

        .day-header {
            font-family: 'Nunito', sans-serif;
            font-size: 18px;
            color: #2d5a3d;
            font-weight: 700;
            padding: 15px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }

        .days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 12px;
        }

        .day-cell {
            height: 70px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            padding: 10px;
        }

        .day-cell:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .day-cell.current-month {
            background: rgba(255, 255, 255, 0.2);
        }

        .day-cell.today {
            background: rgba(134, 180, 153, 0.3);
            border: 3px solid #86b499;
        }

        .day-cell.selected {
            background: rgba(34, 96, 78, 0.3);
            border: 3px solid #22604e;
        }

        .day-number {
            font-family: 'Nunito', sans-serif;
            font-size: 24px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 3px;
        }

        .day-cell.other-month .day-number {
            color: rgba(34, 96, 78, 0.5);
            font-weight: 600;
        }

        .event-indicator {
            width: 8px;
            height: 8px;
            background: #1a3c27;
            border-radius: 50%;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Today Section - WIDER */
        .today-section {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            padding: 25px;
            margin-bottom: 20px;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(34, 96, 78, 0.2);
            width: 480px;
        }

        .today-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .today-title {
            font-family: 'Nunito', sans-serif;
            font-size: 24px;
            color: #1a3c27;
            font-weight: 700;
        }

        .today-date {
            font-family: 'Nunito', sans-serif;
            font-size: 20px;
            color: #2d5a3d;
            font-weight: 600;
        }

        /* Action Buttons - WIDER */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(34, 96, 78, 0.2);
            border-radius: 25px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            gap: 15px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-5px);
            border-color: rgba(34, 96, 78, 0.4);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .btn-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ffffff 0%, #e8f5e9 100%);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #22604e;
        }

        .btn-content {
            flex: 1;
        }

        .btn-title {
            font-family: 'Nunito', sans-serif;
            font-size: 20px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .btn-desc {
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            color: #2d5a3d;
            font-weight: 600;
            opacity: 0.9;
        }

        /* Events Section - WIDER */
        .events-section {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 30px;
            padding: 25px;
            margin-bottom: 130px;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            width: 480px;
        }

        .section-title {
            font-family: 'Nunito', sans-serif;
            font-size: 24px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title i {
            font-size: 22px;
            color: #22604e;
        }

        .events-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .event-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            transition: all 0.3s ease;
            border-left: 5px solid #86b499;
            position: relative;
            overflow: hidden;
            -webkit-user-select: none;
            user-select: none;
        }

        .event-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .event-item.selectable {
            cursor: pointer;
        }

        .event-item.selected {
            background: rgba(52, 152, 219, 0.1);
            border-left: 5px solid #3498db;
            transform: translateX(10px);
        }

        .event-item.deleting {
            animation: shake 0.5s ease;
            border-left: 5px solid #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .event-item.assignment {
            border-left: 5px solid #3498db;
        }

        .event-item.study-session {
            border-left: 5px solid #2ecc71;
        }

        .event-item.exam {
            border-left: 5px solid #e74c3c;
        }

        .event-item.reminder {
            border-left: 5px solid #f39c12;
        }

        .event-time {
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            color: #2d5a3d;
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .event-title {
            font-family: 'Nunito', sans-serif;
            font-size: 18px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .event-subtitle {
            font-family: 'Nunito', sans-serif;
            font-size: 15px;
            color: #2d5a3d;
            font-weight: 600;
        }

        .event-meta {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .event-tag {
            padding: 4px 10px;
            border-radius: 12px;
            font-family: 'Nunito', sans-serif;
            font-size: 11px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .event-tag.importance-high {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .event-tag.importance-medium {
            background: rgba(243, 156, 18, 0.2);
            color: #c78a28;
        }

        .event-tag.importance-low {
            background: rgba(46, 204, 113, 0.1);
            color: #2ecc71;
        }

        .event-tag.difficulty {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .event-tag.course {
            background: rgba(155, 89, 182, 0.1);
            color: #9b59b6;
        }

        /* Event Actions */
        .event-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            height: 0;
            overflow: hidden;
        }

        .event-item:hover .event-actions {
            opacity: 1;
            transform: translateY(0);
            height: auto;
        }

        .event-btn {
            flex: 1;
            padding: 10px 15px;
            border-radius: 12px;
            font-family: 'Nunito', sans-serif;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .event-btn.edit {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }

        .event-btn.edit:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
        }

        .event-btn.delete {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .event-btn.delete:hover {
            background: rgba(231, 76, 60, 0.2);
            transform: translateY(-2px);
        }

        .event-btn.complete {
            background: rgba(46, 204, 113, 0.1);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .event-btn.complete:hover {
            background: rgba(46, 204, 113, 0.2);
            transform: translateY(-2px);
        }

        .event-btn i {
            font-size: 12px;
        }

        .event-item.completed {
            opacity: 0.7;
            background: rgba(46, 204, 113, 0.05);
        }

        .event-item.completed .event-title {
            text-decoration: line-through;
            color: rgba(26, 60, 39, 0.6);
        }

        /* Swipe to Delete */
        .swipe-overlay {
            position: absolute;
            top: 0;
            right: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 16px;
            gap: 10px;
            transition: right 0.3s ease;
            z-index: 1;
        }

        .event-item.swiping .swipe-overlay {
            right: 0;
        }

        /* Delete Confirmation Modal */
        .delete-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .delete-modal-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 25px;
            width: 85%;
            max-height: 80vh;
            text-align: center;
            border: 3px solid rgba(231, 76, 60, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            overflow-y: auto;
        }

        .delete-modal-icon {
            font-size: 50px;
            color: #e74c3c;
            margin-bottom: 20px;
        }

        .delete-modal-title {
            font-family: 'Nunito', sans-serif;
            font-size: 24px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .delete-modal-subtitle {
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            color: #2d5a3d;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .delete-modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .delete-modal-btn {
            padding: 15px 25px;
            border-radius: 18px;
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            flex: 1;
        }

        .delete-modal-btn.cancel {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border-color: rgba(52, 152, 219, 0.3);
        }

        .delete-modal-btn.cancel:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-3px);
        }

        .delete-modal-btn.delete {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border: none;
        }

        .delete-modal-btn.delete:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        /* Study Schedule Modal */
        .schedule-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .schedule-modal-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 25px;
            width: 85%;
            max-height: 80vh;
            text-align: center;
            border: 3px solid rgba(46, 204, 113, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            overflow-y: auto;
        }

        .schedule-modal-icon {
            font-size: 50px;
            color: #2ecc71;
            margin-bottom: 20px;
        }

        .schedule-modal-title {
            font-family: 'Nunito', sans-serif;
            font-size: 24px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .schedule-modal-subtitle {
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            color: #2d5a3d;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .schedule-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
            max-height: 300px;
            overflow-y: auto;
        }

        .schedule-item {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
            border: 2px solid rgba(34, 96, 78, 0.1);
            text-align: left;
            transition: all 0.3s ease;
        }

        .schedule-item:hover {
            transform: translateY(-3px);
            border-color: rgba(34, 96, 78, 0.3);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .schedule-item-date {
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            color: #2d5a3d;
            font-weight: 700;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .schedule-item-title {
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .schedule-item-desc {
            font-family: 'Nunito', sans-serif;
            font-size: 13px;
            color: #2d5a3d;
            font-weight: 600;
        }

        .schedule-item-tags {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .schedule-tag {
            padding: 3px 8px;
            border-radius: 10px;
            font-family: 'Nunito', sans-serif;
            font-size: 10px;
            font-weight: 700;
        }

        .schedule-tag.duration {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .schedule-tag.priority {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .schedule-modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .schedule-modal-btn {
            padding: 15px 25px;
            border-radius: 18px;
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            flex: 1;
        }

        .schedule-modal-btn.cancel {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border-color: rgba(52, 152, 219, 0.3);
        }

        .schedule-modal-btn.cancel:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-3px);
        }

        .schedule-modal-btn.confirm {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border: none;
        }

        .schedule-modal-btn.confirm:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }

        /* Delete All Button */
        .delete-all-btn {
            margin-top: 15px;
            padding: 12px 20px;
            background: rgba(231, 76, 60, 0.1);
            border: 2px solid rgba(231, 76, 60, 0.3);
            border-radius: 15px;
            color: #b53427;
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: none;
            /* Hide by default; JS will set inline style to 'flex' when needed */
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
        }

        .delete-all-btn:hover {
            background: rgba(231, 76, 60, 0.2);
            transform: translateY(-3px);
        }

        /* Selection Mode */
        .selection-mode {
            background: rgba(52, 152, 219, 0.1);
            border: 2px solid rgba(52, 152, 219, 0.3);
        }

        .selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 20px;
            margin-bottom: 15px;
        }

        .selection-count {
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            color: #3498db;
            font-weight: 700;
        }

        .selection-actions {
            display: flex;
            gap: 10px;
        }

        .selection-btn {
            padding: 8px 15px;
            border-radius: 12px;
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .selection-btn.cancel {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }

        .selection-btn.delete {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .selection-btn:hover {
            transform: translateY(-2px);
        }

        /* Google Integration Modal - ADJUSTED FOR PHONE */
        .google-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .google-modal-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 25px;
            width: 85%;
            max-height: 80vh;
            text-align: center;
            border: 3px solid rgba(34, 96, 78, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            overflow-y: auto;
        }

        .google-modal-icon {
            font-size: 50px;
            color: #4285F4;
            margin-bottom: 20px;
        }

        .google-modal-title {
            font-family: 'Nunito', sans-serif;
            font-size: 24px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .google-modal-subtitle {
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            color: #2d5a3d;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .integration-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }

        .integration-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 18px;
            border: 2px solid rgba(34, 96, 78, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .integration-option:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-3px);
            border-color: rgba(34, 96, 78, 0.3);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .integration-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: white;
        }

        .integration-icon.google {
            background: linear-gradient(135deg, #4285F4 0%, #34A853 100%);
        }

        .integration-icon.ical {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF5252 100%);
        }

        .integration-text {
            flex: 1;
            text-align: left;
        }

        .integration-text .title {
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .integration-text .desc {
            font-family: 'Nunito', sans-serif;
            font-size: 13px;
            color: #2d5a3d;
            font-weight: 600;
            opacity: 0.9;
        }

        .google-modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 15px 25px;
            border-radius: 18px;
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            flex: 1;
        }

        .modal-btn.cancel {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border-color: rgba(52, 152, 219, 0.3);
        }

        .modal-btn.cancel:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-3px);
        }

        .modal-btn.connect {
            background: linear-gradient(135deg, #4285F4 0%, #34A853 100%);
            color: white;
            border: none;
        }

        .modal-btn.connect:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.4);
        }

        /* Add/Edit Event/Assignment Modal - ADJUSTED FOR PHONE */
        .add-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .add-modal-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 25px;
            width: 85%;
            max-height: 80vh;
            text-align: center;
            border: 3px solid rgba(34, 96, 78, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            overflow-y: auto;
        }

        .add-modal-icon {
            font-size: 50px;
            color: #22604e;
            margin-bottom: 20px;
        }

        .add-modal-title {
            font-family: 'Nunito', sans-serif;
            font-size: 24px;
            color: #1a3c27;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .add-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }

        .form-group {
            text-align: left;
        }

        .form-label {
            display: block;
            font-family: 'Nunito', sans-serif;
            font-size: 15px;
            color: #1a3c27;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(34, 96, 78, 0.2);
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 15px;
            color: #1a3c27;
            outline: none;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            border-color: #22604e;
            box-shadow: 0 0 0 3px rgba(34, 96, 78, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(34, 96, 78, 0.2);
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 15px;
            color: #1a3c27;
            outline: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .form-select:focus {
            border-color: #22604e;
            box-shadow: 0 0 0 3px rgba(34, 96, 78, 0.1);
        }

        .form-slider-container {
            padding: 10px 0;
        }

        .slider-value {
            text-align: center;
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            color: #2d5a3d;
            font-weight: 600;
            margin-top: 8px;
        }

        .form-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            -webkit-user-select: none;
            user-select: none;
        }

        .form-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #22604e;
        }

        .form-checkbox-label {
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            color: #1a3c27;
            font-weight: 600;
        }

        /* Navigation - WIDER */
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 75px;
            height: 75px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            position: relative;
            border-radius: 20px;
        }

        .nav-item.active {
            background: rgba(34, 96, 78, 0.15);
            transform: translateY(-10px);
        }

        .nav-item:hover:not(.active) {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-5px);
        }

        .nav-icon {
            font-size: 26px;
            color: #22604e;
            margin-bottom: 5px;
            transition: all 0.3s ease;
        }

        .nav-item.active .nav-icon {
            color: #1a3c27;
            transform: scale(1.1);
        }

        .nav-label {
            font-family: 'Nunito', sans-serif;
            font-size: 11px;
            color: #1a3c27;
            font-weight: 700;
        }

        .nav-item.active .nav-label {
            color: #22604e;
            font-weight: 800;
        }

        .nav-badge {
            position: absolute;
            top: 5px;
            right: 10px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            color: white;
            font-family: 'Nunito', sans-serif;
            font-size: 11px;
            font-weight: 800;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 8px rgba(255, 82, 82, 0.4);
            transition: all 0.3s ease;
            z-index: 10;
        }

        /* App Content Adjustments */
        .app-content {
            height: calc(100% - 40px);
            overflow-y: auto;
            padding-bottom: 140px;
        }

        /* Make Bottom Nav Wider */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 28px;
            padding: 18px 12px;
            margin: 0 35px;
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(34, 96, 78, 0.2);
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 45px;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-5px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(5px);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
            opacity: 0;
        }

        /* Custom scrollbar */
        .app-content::-webkit-scrollbar {
            width: 8px;
        }

        .app-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .app-content::-webkit-scrollbar-thumb {
            background: #22604e;
            border-radius: 10px;
        }

        /* Modal scrollbars */
        .google-modal-content::-webkit-scrollbar,
        .add-modal-content::-webkit-scrollbar,
        .delete-modal-content::-webkit-scrollbar,
        .schedule-modal-content::-webkit-scrollbar {
            width: 6px;
        }

        .google-modal-content::-webkit-scrollbar-track,
        .add-modal-content::-webkit-scrollbar-track,
        .delete-modal-content::-webkit-scrollbar-track,
        .schedule-modal-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .google-modal-content::-webkit-scrollbar-thumb,
        .add-modal-content::-webkit-scrollbar-thumb,
        .delete-modal-content::-webkit-scrollbar-thumb,
        .schedule-modal-content::-webkit-scrollbar-thumb {
            background: #22604e;
            border-radius: 10px;
        }

        /* Modal animations */
        .add-modal,
        .schedule-modal,
        .delete-modal,
        .google-modal {
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .add-modal[style*="display: flex"],
        .schedule-modal[style*="display: flex"],
        .delete-modal[style*="display: flex"],
        .google-modal[style*="display: flex"] {
            opacity: 1;
            visibility: visible;
        }

        /* Responsive - Adjusted for wider layout */
        @media (max-width: 600px) {
            .calendar-title {
                font-size: 40px;
            }

            .current-month {
                font-size: 22px;
            }

            .action-buttons {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .action-btn {
                padding: 20px;
            }

            .btn-icon {
                width: 50px;
                height: 50px;
                font-size: 22px;
            }

            .day-cell {
                height: 70px;
            }

            .day-number {
                font-size: 20px;
            }

            .bottom-nav {
                margin: 0 25px;
                padding: 15px 10px;
            }

            .nav-item {
                width: 65px;
                height: 65px;
            }

            .nav-icon {
                font-size: 22px;
            }

            .days-header {
                gap: 3px;
            }

            .day-header {
                font-size: 16px;
                padding: 12px 0;
            }

            .today-btn {
                height: 50px;
                padding: 0 15px;
                font-size: 14px;
            }

            .nav-btn {
                width: 50px;
                height: 50px;
            }

            .event-actions {
                flex-direction: column;
            }

            .event-btn {
                width: 100%;
            }

            .schedule-modal-content,
            .add-modal-content {
                width: 90%;
                padding: 20px;
            }
        }

        /* Feedback Message - Adjusted for phone */
        .feedback-message {
            position: absolute;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(34, 96, 78, 0.95) !important;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            font-size: 14px;
            z-index: 3000;
            animation: slideDown 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            max-width: 80%;
            text-align: center;
            width: auto;
        }

        /* CRITICAL: Ensure badge is completely hidden when empty */
        .nav-badge:empty,
        .nav-badge[style*="display: none"],
        .nav-badge.hidden {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            background: none !important;
            box-shadow: none !important;
            transform: scale(0) !important;
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        /* Slider Styles */
        .slider-container {
            width: 100%;
            padding: 10px 0;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-family: 'Nunito', sans-serif;
            font-size: 12px;
            color: #2d5a3d;
        }

        .slider {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(34, 96, 78, 0.2);
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #22604e;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .slider::-moz-range-thumb {
            -moz-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #22604e;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .event-date {
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            font-weight: 700;
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(34, 96, 78, 0.2);
        }

        .event-item:hover .event-date {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Decorative Elements -->
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>
        <div class="cloud cloud-3"></div>
        <div class="leaf leaf-1"></div>
        <div class="leaf leaf-2"></div>
        <div class="leaf leaf-3"></div>

        <!-- Study Schedule Modal -->
        <div class="schedule-modal" id="scheduleModal">
            <div class="schedule-modal-content">
                <div class="schedule-modal-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <div class="schedule-modal-title">AI Study Schedule Generated</div>
                <div class="schedule-modal-subtitle" id="scheduleModalSubtitle">
                    Based on your assignment details, we've created an optimal study plan:
                </div>

                <div class="schedule-list" id="scheduleList">
                    <!-- Schedule items will be populated here -->
                </div>

                <div class="schedule-modal-buttons">
                    <button class="schedule-modal-btn cancel" id="cancelSchedule">
                        Edit Schedule
                    </button>
                    <button class="schedule-modal-btn confirm" id="confirmSchedule">
                        Add to Calendar
                    </button>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div class="delete-modal" id="deleteModal">
            <div class="delete-modal-content">
                <div class="delete-modal-icon">
                    <i class="fas fa-trash-alt"></i>
                </div>
                <div class="delete-modal-title" id="deleteModalTitle">Delete Event</div>
                <div class="delete-modal-subtitle" id="deleteModalSubtitle">
                    Are you sure you want to delete this event? This action cannot be undone.
                </div>

                <div class="delete-modal-buttons">
                    <button class="delete-modal-btn cancel" id="cancelDelete">
                        Cancel
                    </button>
                    <button class="delete-modal-btn delete" id="confirmDelete">
                        Delete
                    </button>
                </div>
            </div>
        </div>

        <!-- Google Integration Modal -->
        <div class="google-modal" id="googleModal">
            <div class="google-modal-content">
                <div class="google-modal-icon">
                    <i class="fab fa-google"></i>
                </div>
                <div class="google-modal-title">Connect Calendar</div>
                <div class="google-modal-subtitle">
                    Sync your Google Classroom or Calendar to automatically import assignments and events
                </div>

                <div class="integration-options">
                    <div class="integration-option" id="googleConnect">
                        <div class="integration-icon google">
                            <i class="fab fa-google"></i>
                        </div>
                        <div class="integration-text">
                            <div class="title">Sign in with Google</div>
                            <div class="desc">Connect your Google account to sync assignments and events</div>
                        </div>
                    </div>

                    <div class="integration-option" id="iCalConnect">
                        <div class="integration-icon ical">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="integration-text">
                            <div class="title">Import iCal File</div>
                            <div class="desc">Upload an iCal file to import your schedule</div>
                        </div>
                    </div>
                </div>

                <div class="google-modal-buttons">
                    <button class="modal-btn cancel" id="cancelGoogle">
                        Cancel
                    </button>
                    <button class="modal-btn connect" id="connectGoogle">
                        Connect
                    </button>
                </div>
            </div>
        </div>

        <!-- Add/Edit Event/Assignment Modal -->
        <div class="add-modal" id="addEventModal">
            <div class="add-modal-content">
                <div class="add-modal-icon">
                    <i class="fas fa-calendar-plus"></i>
                </div>
                <div class="add-modal-title" id="addModalTitle">Add New Assignment</div>

                <form class="add-form" id="addForm">
                    <div class="form-group">
                        <label class="form-label" for="eventTitle">Assignment Title*</label>
                        <input type="text" id="eventTitle" class="form-input"
                            placeholder="e.g., Math Homework Chapter 5" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="courseName">Course/Subject*</label>
                        <input type="text" id="courseName" class="form-input" placeholder="e.g., Calculus 101" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="eventDate">Due Date*</label>
                        <input type="date" id="eventDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="dueTime">Due Time (Optional)</label>
                        <input type="time" id="dueTime" class="form-input">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="importance">Importance (Weight/Percentage)*</label>
                        <div class="slider-container">
                            <input type="range" min="5" max="50" value="15" class="slider" id="importance">
                            <div class="slider-labels">
                                <span>5% (Low)</span>
                                <span>15%</span>
                                <span>30%</span>
                                <span>50% (High)</span>
                            </div>
                            <div class="slider-value" id="importanceValue">15% of final grade</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="difficulty">Course Difficulty*</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="5" value="3" class="slider" id="difficulty">
                            <div class="slider-labels">
                                <span>Very Easy</span>
                                <span>Easy</span>
                                <span>Medium</span>
                                <span>Hard</span>
                                <span>Very Hard</span>
                            </div>
                            <div class="slider-value" id="difficultyValue">Medium Difficulty</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="currentGrade">Current Grade in Course (Optional)</label>
                        <input type="number" id="currentGrade" class="form-input" placeholder="e.g., 85" min="0"
                            max="100" step="0.1">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="targetGrade">Target Grade (Optional)</label>
                        <input type="number" id="targetGrade" class="form-input" placeholder="e.g., 90" min="0"
                            max="100" step="0.1">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="estimatedHours">Estimated Hours to Complete*</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="20" value="5" class="slider" id="estimatedHours">
                            <div class="slider-labels">
                                <span>1 hour</span>
                                <span>5 hours</span>
                                <span>10 hours</span>
                                <span>15 hours</span>
                                <span>20+ hours</span>
                            </div>
                            <div class="slider-value" id="estimatedHoursValue">5 hours estimated</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="eventDescription">Description (Optional)</label>
                        <input type="text" id="eventDescription" class="form-input"
                            placeholder="e.g., Problems 1-20, show all work">
                    </div>

                    <div class="form-checkbox">
                        <input type="checkbox" id="autoSchedule" checked>
                        <label class="form-checkbox-label" for="autoSchedule">Automatically schedule study
                            sessions</label>
                    </div>
                </form>

                <div class="google-modal-buttons">
                    <button class="modal-btn cancel" id="cancelAdd">
                        Cancel
                    </button>
                    <button class="modal-btn connect" id="saveAdd">
                        Create Schedule
                    </button>
                </div>
            </div>
        </div>

        <!-- Phone Container -->
        <div class="phone" id="main-page">
            <!-- Phone Notch -->
            <div class="phone-notch"></div>

            <!-- Status Bar -->
            <div class="status-bar">
                <span>9:41</span>
                <div class="status-icons">
                    <i class="fas fa-signal"></i>
                    <i class="fas fa-wifi"></i>
                    <i class="fas fa-battery-three-quarters"></i>
                </div>
            </div>

            <!-- App Content -->
            <div class="app-content">
                <!-- Calendar Header -->
                <div class="calendar-header">
                    <div class="header-top">
                        <div>
                            <div class="calendar-title">Calendar</div>
                            <div class="calendar-subtitle">February 2026</div>
                        </div>
                    </div>
                </div>

                <!-- Calendar Navigation with Today Button -->
                <div class="date-navigation">
                    <div class="nav-buttons">
                        <div class="nav-btn" id="prevMonth">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                        <div class="today-btn" id="todayBtn">
                            <i class="fas fa-calendar-day"></i>
                            Today
                        </div>
                    </div>
                    <div class="current-month" id="currentMonth">February 2026</div>
                    <div class="nav-btn" id="nextMonth">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>

                <!-- Calendar Grid -->
                <div class="calendar-grid">
                    <div class="days-header">
                        <div class="day-header">S</div>
                        <div class="day-header">M</div>
                        <div class="day-header">T</div>
                        <div class="day-header">W</div>
                        <div class="day-header">T</div>
                        <div class="day-header">F</div>
                        <div class="day-header">S</div>
                    </div>

                    <div class="days-grid" id="calendarDays">
                        <!-- Calendar days will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Today's Itinerary -->
                <div class="today-section">
                    <div class="today-header">
                        <div class="today-title">Itinerary</div>
                        <div class="today-date" id="todayDate">February 11</div>
                    </div>

                    <div class="events-list" id="todayEvents">
                        <!-- Today's events will be populated by JavaScript -->
                    </div>

                    <!-- Delete All Button (only shown when there are events) -->
                    <button class="delete-all-btn" id="deleteAllTodayBtn">
                        <i class="fas fa-trash-alt"></i>
                        Delete All Today's Events
                    </button>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <a href="#" class="action-btn" id="addAssignmentBtn">
                        <div class="btn-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="btn-content">
                            <div class="btn-title">Add Assignment</div>
                            <div class="btn-desc">Create with AI study schedule</div>
                        </div>
                    </a>

                    <a href="#" class="action-btn" id="addEventBtn">
                        <div class="btn-icon">
                            <i class="far fa-calendar-plus"></i>
                        </div>
                        <div class="btn-content">
                            <div class="btn-title">Add Event</div>
                            <div class="btn-desc">Schedule regular event</div>
                        </div>
                    </a>

                    <a href="#" class="action-btn" id="viewItineraryBtn">
                        <div class="btn-icon">
                            <i class="fas fa-list-alt"></i>
                        </div>
                        <div class="btn-content">
                            <div class="btn-title">View Itinerary</div>
                            <div class="btn-desc">Today's schedule</div>
                        </div>
                    </a>

                    <a href="#" class="action-btn" id="googleIntegrationBtn">
                        <div class="btn-icon">
                            <i class="fab fa-google"></i>
                        </div>
                        <div class="btn-content">
                            <div class="btn-title">Google Sync</div>
                            <div class="btn-desc">Connect calendar</div>
                        </div>
                    </a>

                    <!-- Manage Events Button -->
                    <a href="#" class="action-btn" id="manageEventsBtn">
                        <div class="btn-icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="btn-content">
                            <div class="btn-title">Manage Events</div>
                            <div class="btn-desc">Edit or delete events</div>
                        </div>
                    </a>
                </div>

                <!-- Upcoming Events -->
                <div class="events-section">
                    <!-- Change the section title in the HTML -->
                    <div class="section-title">
                        <i class="fas fa-calendar-day"></i>
                        Upcoming Events (Next 14 Days)
                    </div>

                    <div class="events-list" id="upcomingEvents">
                        <!-- Upcoming events will be populated by JavaScript -->
                    </div>

                    <!-- Delete All Upcoming Button -->
                    <button class="delete-all-btn" id="deleteAllUpcomingBtn">
                        <i class="fas fa-trash-alt"></i>
                        Delete All Upcoming Events
                    </button>
                </div>
            </div>

            <!-- Bottom Navigation Container -->
            <div class="bottom-nav-container">
                <div class="bottom-nav">
                    <a href="dashboard.html" class="nav-item">
                        <div class="nav-icon">
                            <i class="fas fa-home"></i>
                        </div>
                        <div class="nav-label">Home</div>
                    </a>
                    <a href="explore.html" class="nav-item">
                        <div class="nav-icon">
                            <i class="fas fa-compass"></i>
                        </div>
                        <div class="nav-label">Explore</div>
                    </a>
                    <a href="notifications.html" class="nav-item">
                        <div class="nav-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="nav-label">Alerts</div>
                        <div class="nav-badge" id="bottomNavBadge">6</div>
                    </a>
                    <a href="profile.html" class="nav-item">
                        <div class="nav-icon">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="nav-label">Profile</div>
                    </a>
                </div>
            </div>

            <!-- Home Indicator -->
            <div class="home-indicator"></div>
        </div>
    </div>

    <!-- Script -->
    <script src="calendar-db.js"></script>
    <script>
        // Import the UserDatabase class from profile.html
        (function () {
            if (typeof window.UserDatabase === 'undefined') {
                window.UserDatabase = class {
                    constructor() {
                        this.key = 'heyday_users';
                        this.currentUserKey = 'heyday_current_user';
                        this.googleUserKey = 'heyday_google_user';
                        this.notificationSettingsKey = 'heyday_notification_settings';
                    }

                    getCurrentUser() {
                        const user = localStorage.getItem(this.currentUserKey);
                        return user ? JSON.parse(user) : null;
                    }

                    isLoggedIn() {
                        return localStorage.getItem('heyday_logged_in') === 'true';
                    }

                    logout() {
                        localStorage.removeItem(this.currentUserKey);
                        localStorage.removeItem('heyday_logged_in');
                        localStorage.removeItem(this.googleUserKey);
                        return true;
                    }

                    saveGoogleUser(googleUser) {
                        localStorage.setItem(this.googleUserKey, JSON.stringify(googleUser));
                    }

                    getGoogleUser() {
                        const user = localStorage.getItem(this.googleUserKey);
                        return user ? JSON.parse(user) : null;
                    }

                    disconnectGoogle() {
                        localStorage.removeItem(this.googleUserKey);
                        return true;
                    }

                    linkGoogleAccount(userId, googleData) {
                        const users = JSON.parse(localStorage.getItem(this.key) || '[]');
                        const userIndex = users.findIndex(u => u.id === userId);

                        if (userIndex !== -1) {
                            users[userIndex].googleAccount = {
                                id: googleData.id,
                                email: googleData.email,
                                name: googleData.name,
                                picture: googleData.picture,
                                linkedAt: new Date().toISOString()
                            };

                            localStorage.setItem(this.key, JSON.stringify(users));

                            const currentUser = this.getCurrentUser();
                            if (currentUser && currentUser.id === userId) {
                                currentUser.googleAccount = users[userIndex].googleAccount;
                                localStorage.setItem(this.currentUserKey, JSON.stringify(currentUser));
                            }

                            return true;
                        }
                        return false;
                    }

                    // NOTIFICATION MANAGEMENT METHODS
                    getNotifications(userId) {
                        const users = this.getAllUsers();
                        const user = users.find(u => u.id === userId);
                        return user ? (user.notifications || {
                            calendar: 0,
                            mentalHealth: 0,
                            henry: 0,
                            system: 0
                        }) : {};
                    }

                    getAllUsers() {
                        const users = localStorage.getItem(this.key);
                        return users ? JSON.parse(users) : [];
                    }

                    saveAllUsers(users) {
                        localStorage.setItem(this.key, JSON.stringify(users));
                    }

                    updateNotifications(userId, newNotifications) {
                        const users = this.getAllUsers();
                        const userIndex = users.findIndex(u => u.id === userId);
                        if (userIndex !== -1) {
                            users[userIndex].notifications = newNotifications;
                            this.saveAllUsers(users);

                            const currentUser = this.getCurrentUser();
                            if (currentUser && currentUser.id === userId) {
                                currentUser.notifications = newNotifications;
                                localStorage.setItem(this.currentUserKey, JSON.stringify(currentUser));
                            }
                            return true;
                        }
                        return false;
                    }

                    markAllNotificationsRead(userId) {
                        const currentNotifications = this.getNotifications(userId);
                        const updatedNotifications = {};

                        Object.keys(currentNotifications).forEach(key => {
                            updatedNotifications[key] = 0;
                        });

                        this.updateNotifications(userId, updatedNotifications);
                        return updatedNotifications;
                    }

                    markNotificationTypeRead(userId, type) {
                        const currentNotifications = this.getNotifications(userId);
                        if (currentNotifications[type] !== undefined) {
                            currentNotifications[type] = Math.max(0, currentNotifications[type] - 1);
                            this.updateNotifications(userId, currentNotifications);
                        }
                        return currentNotifications;
                    }

                    getTotalUnreadNotifications(userId) {
                        const notifications = this.getNotifications(userId);
                        return Object.values(notifications).reduce((sum, count) => sum + count, 0);
                    }

                    initializeDefaultNotifications(userId) {
                        const defaultNotifications = {
                            calendar: 0,
                            mentalHealth: 0,
                            henry: 0,
                            system: 0
                        };

                        const users = this.getAllUsers();
                        const userIndex = users.findIndex(u => u.id === userId);
                        if (userIndex !== -1 && !users[userIndex].notifications) {
                            users[userIndex].notifications = defaultNotifications;
                            this.saveAllUsers(users);

                            const currentUser = this.getCurrentUser();
                            if (currentUser && currentUser.id === userId) {
                                currentUser.notifications = defaultNotifications;
                                localStorage.setItem(this.currentUserKey, JSON.stringify(currentUser));
                            }
                        }
                        return defaultNotifications;
                    }

                    // NOTIFICATION SETTINGS MANAGEMENT
                    getNotificationSettings(userId) {
                        const settings = localStorage.getItem(this.notificationSettingsKey);
                        const allSettings = settings ? JSON.parse(settings) : {};
                        return allSettings[userId] || {
                            enabled: true,
                            calendar: true,
                            mentalHealth: true,
                            henry: true,
                            system: true,
                            sound: true,
                            vibration: true
                        };
                    }

                    saveNotificationSettings(userId, settings) {
                        const allSettings = JSON.parse(localStorage.getItem(this.notificationSettingsKey) || '{}');
                        allSettings[userId] = settings;
                        localStorage.setItem(this.notificationSettingsKey, JSON.stringify(allSettings));
                        return true;
                    }

                    updateNotificationSetting(userId, settingKey, value) {
                        const settings = this.getNotificationSettings(userId);
                        settings[settingKey] = value;
                        return this.saveNotificationSettings(userId, settings);
                    }
                };
            }
        })();

        // Calendar Read Events Tracker
        (function () {
            if (typeof window.CalendarNotificationTracker === 'undefined') {
                window.CalendarNotificationTracker = {
                    key: 'heyday_calendar_read_events',

                    // Get all read event IDs for current user
                    getReadEvents(userId) {
                        const allReadEvents = JSON.parse(localStorage.getItem(this.key) || '{}');
                        return allReadEvents[userId] || [];
                    },

                    // Mark an event as read
                    markEventAsRead(userId, eventId) {
                        const allReadEvents = JSON.parse(localStorage.getItem(this.key) || '{}');
                        if (!allReadEvents[userId]) {
                            allReadEvents[userId] = [];
                        }

                        if (!allReadEvents[userId].includes(eventId)) {
                            allReadEvents[userId].push(eventId);
                            localStorage.setItem(this.key, JSON.stringify(allReadEvents));
                        }
                        return true;
                    },

                    // Check if an event is read
                    isEventRead(userId, eventId) {
                        const readEvents = this.getReadEvents(userId);
                        return readEvents.includes(eventId);
                    },

                    // Remove read status for an event
                    markEventAsUnread(userId, eventId) {
                        const allReadEvents = JSON.parse(localStorage.getItem(this.key) || '{}');
                        if (allReadEvents[userId]) {
                            const index = allReadEvents[userId].indexOf(eventId);
                            if (index > -1) {
                                allReadEvents[userId].splice(index, 1);
                                localStorage.setItem(this.key, JSON.stringify(allReadEvents));
                            }
                        }
                        return true;
                    },

                    // Clear all read events for user
                    clearReadEvents(userId) {
                        const allReadEvents = JSON.parse(localStorage.getItem(this.key) || '{}');
                        delete allReadEvents[userId];
                        localStorage.setItem(this.key, JSON.stringify(allReadEvents));
                    },

                    // Get count of unread events from a list
                    countUnreadEvents(userId, events) {
                        if (!events || events.length === 0) return 0;

                        const readEvents = this.getReadEvents(userId);
                        const unreadEvents = events.filter(event => {
                            const eventKey = `${event.dateString}-${event.id}`;
                            return !readEvents.includes(eventKey);
                        });
                        return unreadEvents.length;
                    },

                    // Get only unread events from a list
                    getUnreadEvents(userId, events) {
                        if (!events || events.length === 0) return [];

                        const readEvents = this.getReadEvents(userId);
                        return events.filter(event => {
                            const eventKey = `${event.dateString}-${event.id}`;
                            return !readEvents.includes(eventKey);
                        });
                    }
                };
            }
        })();

        document.addEventListener('DOMContentLoaded', function () {
            const userDB = new window.UserDatabase();
            const calendarDB = new CalendarDatabase();
            const tracker = window.CalendarNotificationTracker;

            // Check if user is logged in
            if (!userDB.isLoggedIn()) {
                window.location.href = 'login.html';
                return;
            }

            // Get current user
            const currentUser = userDB.getCurrentUser();
            if (!currentUser) {
                userDB.logout();
                window.location.href = 'login.html';
                return;
            }

            const userId = currentUser.id;

            // Initialize notifications if not exists
            if (!currentUser.notifications) {
                userDB.initializeDefaultNotifications(currentUser.id);
                // Refresh user data
                currentUser.notifications = userDB.getNotifications(currentUser.id);
            }

            /* ---------- NOTIFICATION BADGE MANAGEMENT ---------- */
            function updateNotificationBadge() {
                if (!currentUser) return;

                const totalUnread = userDB.getTotalUnreadNotifications(currentUser.id);
                const bottomNavBadge = document.getElementById('bottomNavBadge');

                if (bottomNavBadge) {
                    if (totalUnread > 0) {
                        bottomNavBadge.textContent = totalUnread > 9 ? '9+' : totalUnread;
                        bottomNavBadge.style.display = 'flex';
                        bottomNavBadge.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%)';
                        bottomNavBadge.style.boxShadow = '0 3px 8px rgba(255, 82, 82, 0.4)';
                        bottomNavBadge.classList.add('pulse-animation');
                    } else {
                        // Hide badge completely when no notifications
                        bottomNavBadge.style.display = 'none';
                        bottomNavBadge.textContent = '';
                        bottomNavBadge.classList.remove('pulse-animation');
                        bottomNavBadge.style.background = 'none';
                        bottomNavBadge.style.boxShadow = 'none';
                    }
                }
            }

            /* ---------- CALENDAR NOTIFICATION UPDATES ---------- */
            function updateCalendarNotifications() {
                // Get events within 3 days
                const upcomingEvents = calendarDB.getEventsWithinDays(3);

                // Count only UNREAD events using the tracker
                const unreadCount = tracker.countUnreadEvents(userId, upcomingEvents);

                // Get current notifications
                const currentNotifications = userDB.getNotifications(userId);

                // Only update if count has changed
                if (unreadCount !== (currentNotifications.calendar || 0)) {
                    currentNotifications.calendar = unreadCount;
                    userDB.updateNotifications(userId, currentNotifications);

                    // Update current user data
                    currentUser.notifications = currentNotifications;
                }

                // Update badge in this page
                updateNotificationBadge();

                // Show feedback if NEW events are approaching (only once per session)
                const notificationShown = sessionStorage.getItem('calendar_notification_shown');
                if (unreadCount > 0 && !notificationShown) {
                    showFeedback(`${unreadCount} new event${unreadCount > 1 ? 's' : ''} coming up in the next 3 days`, 'info');
                    sessionStorage.setItem('calendar_notification_shown', 'true');
                }
            }

            // Calendar State
            const calendarData = {
                currentDate: new Date(2026, 1, 11) // February 11, 2026
            };

            // State variables
            let selectedEventForDeletion = null;
            let selectedEventForEditing = null;
            let isSelectionMode = false;
            let selectedEvents = new Set();
            let touchStartX = 0;
            let touchStartY = 0;
            let touchEndX = 0;
            let touchEndY = 0;
            let longPressTimer = null;
            let generatedSchedule = null;
            let currentAssignment = null;

            // Modal Elements
            const googleModal = document.getElementById('googleModal');
            const addEventModal = document.getElementById('addEventModal');
            const deleteModal = document.getElementById('deleteModal');
            const scheduleModal = document.getElementById('scheduleModal');
            const addAssignmentBtn = document.getElementById('addAssignmentBtn');
            const addEventBtn = document.getElementById('addEventBtn');
            const manageEventsBtn = document.getElementById('manageEventsBtn');
            const googleIntegrationBtn = document.getElementById('googleIntegrationBtn');
            const viewItineraryBtn = document.getElementById('viewItineraryBtn');
            const deleteAllTodayBtn = document.getElementById('deleteAllTodayBtn');
            const deleteAllUpcomingBtn = document.getElementById('deleteAllUpcomingBtn');
            const cancelGoogle = document.getElementById('cancelGoogle');
            const connectGoogle = document.getElementById('connectGoogle');
            const cancelAdd = document.getElementById('cancelAdd');
            const saveAdd = document.getElementById('saveAdd');
            const cancelDelete = document.getElementById('cancelDelete');
            const confirmDelete = document.getElementById('confirmDelete');
            const cancelSchedule = document.getElementById('cancelSchedule');
            const confirmSchedule = document.getElementById('confirmSchedule');
            const googleConnect = document.getElementById('googleConnect');
            const iCalConnect = document.getElementById('iCalConnect');
            const addForm = document.getElementById('addForm');
            const addModalTitle = document.getElementById('addModalTitle');
            const deleteModalTitle = document.getElementById('deleteModalTitle');
            const deleteModalSubtitle = document.getElementById('deleteModalSubtitle');
            const scheduleList = document.getElementById('scheduleList');
            const scheduleModalSubtitle = document.getElementById('scheduleModalSubtitle');

            // Form sliders and values
            const importanceSlider = document.getElementById('importance');
            const importanceValue = document.getElementById('importanceValue');
            const difficultySlider = document.getElementById('difficulty');
            const difficultyValue = document.getElementById('difficultyValue');
            const estimatedHoursSlider = document.getElementById('estimatedHours');
            const estimatedHoursValue = document.getElementById('estimatedHoursValue');

            // Calendar Elements
            const calendarDays = document.getElementById('calendarDays');
            const currentMonth = document.getElementById('currentMonth');
            const prevMonthBtn = document.getElementById('prevMonth');
            const nextMonthBtn = document.getElementById('nextMonth');
            const todayDate = document.getElementById('todayDate');
            const todayEvents = document.getElementById('todayEvents');
            const upcomingEventsList = document.getElementById('upcomingEvents');

            // Today Button
            const todayBtn = document.getElementById('todayBtn');

            // Initialize Calendar
            function initCalendar() {
                updateCalendar();
                updateTodaySection();
                updateUpcomingEvents();

                // Make sure today is selected on init
                const today = new Date(2026, 1, 11);
                selectDay(today);

                // Update notification badge
                updateNotificationBadge();

                // Update calendar notifications
                updateCalendarNotifications();

                // Initialize slider value displays
                updateSliderValues();
            }

            // Update slider value displays
            function updateSliderValues() {
                // Only update if sliders exist (for assignment modal)
                if (importanceSlider && importanceValue) {
                    const importance = parseInt(importanceSlider.value);
                    importanceValue.textContent = `${importance}% of final grade`;
                }

                if (difficultySlider && difficultyValue) {
                    const difficulty = parseInt(difficultySlider.value);
                    const difficultyLabels = ['Very Easy', 'Easy', 'Medium', 'Hard', 'Very Hard'];
                    difficultyValue.textContent = `${difficultyLabels[difficulty - 1]} Difficulty`;
                }

                if (estimatedHoursSlider && estimatedHoursValue) {
                    const hours = parseInt(estimatedHoursSlider.value);
                    estimatedHoursValue.textContent = `${hours} ${hours === 1 ? 'hour' : 'hours'} estimated`;
                }
            }

            // Update Calendar Display
            function updateCalendar() {
                const year = calendarData.currentDate.getFullYear();
                const month = calendarData.currentDate.getMonth();

                // Update month display
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                    'July', 'August', 'September', 'October', 'November', 'December'];
                currentMonth.textContent = `${monthNames[month]} ${year}`;

                // Clear previous days
                calendarDays.innerHTML = '';

                // Get first day of month and total days
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const totalDays = lastDay.getDate();
                const firstDayIndex = firstDay.getDay();

                // Previous month days
                const prevMonthLastDay = new Date(year, month, 0).getDate();
                for (let i = firstDayIndex - 1; i >= 0; i--) {
                    const day = prevMonthLastDay - i;
                    const dayElement = createDayElement(day, 'other-month');
                    calendarDays.appendChild(dayElement);
                }

                // Current month days
                const today = new Date(2026, 1, 11); // Fixed to February 11, 2026
                const isCurrentMonth = today.getFullYear() === year && today.getMonth() === month;

                for (let day = 1; day <= totalDays; day++) {
                    const date = new Date(year, month, day);
                    const dateString = formatDate(date);
                    const events = calendarDB.getEventsForDate(dateString);
                    const hasEvents = events.length > 0;
                    const isToday = isCurrentMonth && day === today.getDate();

                    const dayElement = createDayElement(day, 'current-month', events, isToday, date);
                    calendarDays.appendChild(dayElement);
                }

                // Next month days
                const totalCells = 42; // 6 weeks * 7 days
                const remainingCells = totalCells - (firstDayIndex + totalDays);
                for (let day = 1; day <= remainingCells; day++) {
                    const dayElement = createDayElement(day, 'other-month');
                    calendarDays.appendChild(dayElement);
                }
            }

            // Create Day Element
            function createDayElement(day, className, events = [], isToday = false, date = null) {
                const dayElement = document.createElement('div');
                dayElement.className = `day-cell ${className}`;
                if (isToday) dayElement.classList.add('today');

                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);

                // Add ONE red dot indicator in the center for any events
                if (events.length > 0) {
                    // Clear any existing indicators first
                    const existingIndicators = dayElement.querySelectorAll('.event-indicator');
                    existingIndicators.forEach(ind => ind.remove());

                    // Create single red dot in center
                    const eventIndicator = document.createElement('div');
                    eventIndicator.className = 'event-indicator';
                    eventIndicator.style.cssText = `
                width: 8px;
                height: 8px;
                background: #1a3c27;
                border-radius: 50%;
                position: absolute;
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
            `;
                    dayElement.appendChild(eventIndicator);
                }

                if (date) {
                    dayElement.addEventListener('click', function () {
                        selectDay(date);
                    });
                }

                return dayElement;
            }

            // Select Day
            function selectDay(date) {
                // Remove selected class from all days
                document.querySelectorAll('.day-cell').forEach(cell => {
                    cell.classList.remove('selected');
                });

                // Add selected class to clicked day
                const dayElements = document.querySelectorAll('.day-cell');
                const dayIndex = Array.from(dayElements).findIndex(cell => {
                    return cell.querySelector('.day-number').textContent == date.getDate() &&
                        cell.classList.contains('current-month');
                });

                if (dayIndex !== -1) {
                    dayElements[dayIndex].classList.add('selected');

                    // Show events for selected day
                    const dateString = formatDate(date);
                    const events = calendarDB.getEventsForDate(dateString);
                    showDayEvents(date, events);
                }
            }

            // Show Day Events
            function showDayEvents(date, events) {
                const dateString = formatDate(date);
                const dateDisplay = formatDateDisplay(date);

                // Update today section
                todayDate.textContent = dateDisplay;

                // Clear current events
                todayEvents.innerHTML = '';

                if (events.length === 0) {
                    const noEvents = document.createElement('div');
                    noEvents.className = 'event-item';
                    noEvents.innerHTML = `
                    <div class="event-title">No events scheduled</div>
                    <div class="event-subtitle">Click "Add Event" to schedule something</div>
                `;
                    todayEvents.appendChild(noEvents);
                    deleteAllTodayBtn.style.display = 'none';
                } else {
                    events.forEach(event => {
                        const eventItem = createEventItem(event, dateString, false); // Don't show date for today's section
                        todayEvents.appendChild(eventItem);
                    });
                    deleteAllTodayBtn.style.display = 'flex';
                }

                showFeedback(`Showing events for ${dateDisplay}`, 'info');
            }

            // Get relative date text (Today, Tomorrow, or formatted date)
            function getRelativeDate(dateString) {
                const today = new Date(2026, 1, 11);
                const tomorrow = new Date(today);
                tomorrow.setDate(today.getDate() + 1);

                if (dateString === formatDate(today)) {
                    return 'Today';
                } else if (dateString === formatDate(tomorrow)) {
                    return 'Tomorrow';
                } else {
                    const date = parseDateFromString(dateString);
                    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                        'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    const month = monthNames[date.getMonth()];
                    const day = date.getDate();
                    return `${month} ${day}`;
                }
            }

            // Create Event Item with delete functionality
            function createEventItem(event, dateString, showDate = false) {
                const eventItem = document.createElement('div');
                eventItem.className = `event-item selectable ${event.type} ${event.completed ? 'completed' : ''}`;
                eventItem.dataset.id = event.id;
                eventItem.dataset.date = dateString;

                // Swipe overlay for delete
                const swipeOverlay = document.createElement('div');
                swipeOverlay.className = 'swipe-overlay';
                swipeOverlay.innerHTML = `
                <i class="fas fa-trash-alt"></i>
                Swipe to Delete
            `;
                eventItem.appendChild(swipeOverlay);

                // Format date for display if needed
                let dateDisplay = '';
                if (showDate) {
                    const relativeDate = getRelativeDate(dateString);

                    // Set color based on date
                    let color = '#2d5a3d'; // Default
                    if (relativeDate === 'Today') color = '#2ecc71';
                    if (relativeDate === 'Tomorrow') color = '#3498db';

                    dateDisplay = `<div class="event-date" style="color: ${color};">${relativeDate}</div>`;
                }

                // Event content
                const eventContent = document.createElement('div');

                eventContent.innerHTML = `
                <div class="event-time">
                    <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="far fa-clock"></i>
                            ${event.time}
                        </div>
                        ${dateDisplay}
                    </div>
                    ${event.completed ? '<span style="color: #2ecc71; margin-left: 10px;"><i class="fas fa-check-circle"></i> Completed</span>' : ''}
                </div>
                <div class="event-title">${event.title}</div>
                <div class="event-subtitle">${event.subtitle}</div>
                <div class="event-actions">
                    ${!event.completed && (event.type === 'assignment' || event.type === 'study') ?
                        `<button class="event-btn complete" data-id="${event.id}">
                            <i class="fas fa-check-circle"></i>
                            Mark Complete
                        </button>` : ''
                    }
                    <button class="event-btn edit" data-id="${event.id}">
                        <i class="fas fa-edit"></i>
                        Edit
                    </button>
                    <button class="event-btn delete" data-id="${event.id}">
                        <i class="fas fa-trash-alt"></i>
                        Delete
                    </button>
                </div>
            `;
                eventItem.appendChild(eventContent);

                // Add event listeners
                const editBtn = eventItem.querySelector('.event-btn.edit');
                const deleteBtn = eventItem.querySelector('.event-btn.delete');
                const completeBtn = eventItem.querySelector('.event-btn.complete');

                editBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    openEditModal(event, dateString);
                });

                deleteBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    openDeleteModal(event, dateString, 'single');
                });

                if (completeBtn) {
                    completeBtn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        markEventComplete(event.id, dateString);
                    });
                }

                // Touch events for swipe and long press
                eventItem.addEventListener('touchstart', handleTouchStart);
                eventItem.addEventListener('touchmove', handleTouchMove);
                eventItem.addEventListener('touchend', handleTouchEnd);
                eventItem.addEventListener('click', function (e) {
                    if (isSelectionMode) {
                        toggleEventSelection(event.id);
                        e.stopPropagation();
                    }
                });

                // Long press for selection mode
                eventItem.addEventListener('touchstart', function (e) {
                    longPressTimer = setTimeout(() => {
                        if (!isSelectionMode) {
                            enableSelectionMode();
                        }
                        toggleEventSelection(event.id);
                    }, 800); // 800ms for long press
                });

                eventItem.addEventListener('touchend', function () {
                    clearTimeout(longPressTimer);
                });

                return eventItem;
            }

            // Mark event as complete
            function markEventComplete(eventId, dateString) {
                const events = calendarDB.getEventsForDate(dateString);
                const event = events.find(e => e.id === eventId);
                if (event) {
                    event.completed = true;
                    event.time = 'Completed';
                    calendarDB.saveEvent(dateString, event);

                    // Update UI
                    updateCalendar();
                    updateTodaySection();
                    updateUpcomingEvents();

                    // Show completion animation
                    const eventElement = document.querySelector(`[data-id="${eventId}"]`);
                    if (eventElement) {
                        eventElement.classList.add('completed');
                        eventElement.style.animation = 'pulse 0.5s ease';
                        setTimeout(() => {
                            eventElement.style.animation = '';
                        }, 500);
                    }

                    showFeedback(`"${event.title}" marked as complete!`, 'success');

                    // If it's a study session for an assignment, check if all sessions are complete
                    if (event.assignmentId) {
                        checkAssignmentCompletion(event.assignmentId);
                    }
                }
            }

            // Check if all study sessions for an assignment are complete
            function checkAssignmentCompletion(assignmentId) {
                const allEvents = calendarDB.getAllEventsWithDates();
                let allComplete = true;
                let assignmentTitle = '';

                allEvents.forEach(eventData => {
                    if (eventData.assignmentId === assignmentId && eventData.type === 'study') {
                        if (!eventData.completed) {
                            allComplete = false;
                        }
                        if (!assignmentTitle && eventData.assignmentTitle) {
                            assignmentTitle = eventData.assignmentTitle;
                        }
                    }
                });

                if (allComplete && assignmentTitle) {
                    showFeedback(`All study sessions for "${assignmentTitle}" are complete! Great job! `, 'success');
                }
            }

            // Touch handlers for swipe to delete
            function handleTouchStart(e) {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }

            function handleTouchMove(e) {
                if (!touchStartX || !touchStartY) return;

                touchEndX = e.touches[0].clientX;
                touchEndY = e.touches[0].clientY;

                const diffX = touchStartX - touchEndX;
                const diffY = touchStartY - touchEndY;

                // Only trigger swipe if horizontal movement is greater than vertical
                if (Math.abs(diffX) > Math.abs(diffY) && diffX > 50) {
                    e.currentTarget.classList.add('swiping');
                    e.preventDefault(); // Prevent scrolling while swiping
                }
            }

            function handleTouchEnd(e) {
                if (!touchStartX || !touchStartY) return;

                const diffX = touchStartX - touchEndX;

                // If swiped left enough, show delete confirmation
                if (diffX > 100) {
                    const eventItem = e.currentTarget;
                    const eventId = eventItem.dataset.id;
                    const dateString = eventItem.dataset.date;
                    const events = calendarDB.getEventsForDate(dateString);
                    const event = events.find(e => e.id === eventId);

                    if (event) {
                        openDeleteModal(event, dateString, 'single');
                    }
                }

                // Reset swipe state
                e.currentTarget.classList.remove('swiping');
                touchStartX = 0;
                touchStartY = 0;
                touchEndX = 0;
                touchEndY = 0;
            }

            /* ---------- AI STUDY SCHEDULER ---------- */
            function generateStudySchedule(assignment) {
                const schedule = [];
                const today = new Date(2026, 1, 11); // February 11, 2026
                const dueDate = parseDateFromString(assignment.dueDate);

                // Calculate days until due date
                const daysUntilDue = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));
                if (daysUntilDue < 0) {
                    showFeedback('Due date cannot be in the past', 'error');
                    return null;
                }

                // Calculate total study hours needed
                let totalHours = assignment.estimatedHours;

                // Adjust based on difficulty
                const difficultyMultiplier = {
                    1: 0.7,  // Very Easy
                    2: 0.85, // Easy
                    3: 1.0,  // Medium
                    4: 1.2,  // Hard
                    5: 1.5   // Very Hard
                };
                totalHours *= difficultyMultiplier[assignment.difficulty] || 1.0;

                // Adjust based on importance
                const importanceMultiplier = assignment.importance / 15; // 15% is baseline
                totalHours *= importanceMultiplier;

                // Adjust based on grade pressure
                if (assignment.currentGrade && assignment.targetGrade) {
                    const gradeGap = assignment.targetGrade - assignment.currentGrade;
                    if (gradeGap > 0) {
                        totalHours *= (1 + (gradeGap / 100));
                    }
                }

                totalHours = Math.max(1, Math.min(20, Math.round(totalHours)));

                // Determine session length (1-3 hours based on difficulty)
                const sessionLength = Math.min(3, Math.max(1, Math.ceil(assignment.difficulty / 2)));
                const totalSessions = Math.ceil(totalHours / sessionLength);

                // Determine session distribution
                let sessionDistribution = [];
                if (daysUntilDue >= 7) {
                    // Long timeline: 2 sessions per week, more frequent near due date
                    const weeks = Math.ceil(daysUntilDue / 7);
                    for (let i = 0; i < totalSessions; i++) {
                        const week = Math.min(weeks - 1, Math.floor(i / 2));
                        const dayInWeek = i % 2 === 0 ? 1 : 3; // Monday and Wednesday
                        sessionDistribution.push({
                            daysFromNow: week * 7 + dayInWeek,
                            length: sessionLength
                        });
                    }
                } else if (daysUntilDue >= 3) {
                    // Medium timeline: distribute evenly
                    for (let i = 0; i < totalSessions; i++) {
                        const dayOffset = Math.floor((i / totalSessions) * (daysUntilDue - 1)) + 1;
                        sessionDistribution.push({
                            daysFromNow: dayOffset,
                            length: sessionLength
                        });
                    }
                } else {
                    // Short timeline: multiple sessions per day
                    const sessionsPerDay = Math.ceil(totalSessions / daysUntilDue);
                    for (let day = 1; day <= daysUntilDue; day++) {
                        for (let session = 0; session < sessionsPerDay; session++) {
                            if (sessionDistribution.length < totalSessions) {
                                sessionDistribution.push({
                                    daysFromNow: day,
                                    length: Math.min(2, sessionLength) // Shorter sessions for cramming
                                });
                            }
                        }
                    }
                }

                // Sort by date
                sessionDistribution.sort((a, b) => a.daysFromNow - b.daysFromNow);

                // Create schedule items
                sessionDistribution.forEach((session, index) => {
                    const sessionDate = new Date(today);
                    sessionDate.setDate(today.getDate() + session.daysFromNow);
                    const dateString = formatDate(sessionDate);

                    // Determine session focus based on progress
                    let focus = '';
                    if (index === 0) focus = 'Introduction & Planning';
                    else if (index === sessionDistribution.length - 1) focus = 'Final Review & Practice';
                    else if (index < sessionDistribution.length / 2) focus = 'Core Concepts';
                    else focus = 'Application & Problem Solving';

                    // Determine priority
                    let priority = 'medium';
                    if (session.daysFromNow <= 2) priority = 'high';
                    if (session.daysFromNow >= daysUntilDue - 1) priority = 'high';

                    schedule.push({
                        date: sessionDate,
                        dateString: dateString,
                        title: `${assignment.course}: ${focus}`,
                        description: `Study session ${index + 1}/${totalSessions} for "${assignment.title}"`,
                        length: session.length,
                        priority: priority,
                        assignmentId: assignment.id,
                        assignmentTitle: assignment.title
                    });
                });

                return {
                    schedule: schedule,
                    totalHours: totalHours,
                    totalSessions: totalSessions,
                    daysUntilDue: daysUntilDue
                };
            }

            // Display generated schedule
            function displaySchedule(scheduleData) {
                scheduleList.innerHTML = '';

                if (!scheduleData || !scheduleData.schedule) {
                    scheduleList.innerHTML = `
            <div class="schedule-item">
                <div class="schedule-item-title">Unable to generate schedule</div>
                <div class="schedule-item-desc">Please check your assignment details and try again.</div>
            </div>
        `;
                    return;
                }

                // Calculate daily workload
                const scheduler = new StudyScheduler();
                const dailyWorkload = scheduler.calculateDailyWorkload(scheduleData.schedule);
                const adjustments = scheduler.suggestBalanceAdjustments(scheduleData.schedule);

                // Display schedule items
                scheduleData.schedule.forEach((session, index) => {
                    const scheduleItem = document.createElement('div');
                    scheduleItem.className = 'schedule-item';

                    const priorityText = session.priority === 'high' ? 'High Priority' :
                        session.priority === 'medium' ? 'Medium Priority' : 'Normal Priority';

                    const dayType = session.isWeekend ? 'Weekend' : 'Weekday';
                    const breakDuration = scheduler.calculateBreakDuration(session.length);

                    scheduleItem.innerHTML = `
            <div class="schedule-item-date">
                <i class="far fa-calendar"></i>
                ${formatDateDisplay(session.date)}  ${session.length} ${session.length === 1 ? 'hour' : 'hours'}
                <span class="schedule-tag" style="margin-left: 8px; background: ${session.isWeekend ? 'rgba(155, 89, 182, 0.1)' : 'rgba(52, 152, 219, 0.1)'}; color: ${session.isWeekend ? '#9b59b6' : '#3498db'};">
                    <i class="fas ${session.isWeekend ? 'fa-umbrella-beach' : 'fa-briefcase'}"></i> ${dayType}
                </span>
            </div>
            <div class="schedule-item-title">${session.title}</div>
            <div class="schedule-item-desc">${session.description}</div>
            <div class="schedule-item-tags">
                <span class="schedule-tag duration">
                    <i class="far fa-clock"></i> ${session.length}h
                </span>
                <span class="schedule-tag priority">
                    <i class="fas fa-exclamation-circle"></i> ${priorityText}
                </span>
                <span class="schedule-tag">
                    <i class="fas fa-layer-group"></i> Session ${index + 1}
                </span>
                <span class="schedule-tag">
                    <i class="fas fa-coffee"></i> ${breakDuration}m break
                </span>
            </div>
            <div class="schedule-item-desc" style="margin-top: 8px; font-size: 12px;">
                <i class="fas fa-lightbulb"></i> ${session.optimalTime}  Focus: ${session.focus}
            </div>
        `;

                    scheduleList.appendChild(scheduleItem);
                });

                // Add workload summary
                const summaryItem = document.createElement('div');
                summaryItem.className = 'schedule-item';
                summaryItem.style.marginTop = '20px';
                summaryItem.style.background = 'rgba(52, 152, 219, 0.05)';

                const weekendSessions = scheduleData.schedule.filter(s => s.isWeekend).length;
                const weekdaySessions = scheduleData.schedule.length - weekendSessions;

                summaryItem.innerHTML = `
        <div class="schedule-item-title"> Workload Summary</div>
        <div class="schedule-item-desc">
             Total: ${scheduleData.totalSessions} sessions over ${scheduleData.studyDays} study days<br>
             Weekdays: ${weekdaySessions} sessions (${Math.round(weekdaySessions / scheduleData.totalSessions * 100)}%)<br>
             Weekends: ${weekendSessions} sessions (${Math.round(weekendSessions / scheduleData.totalSessions * 100)}%)<br>
             Average daily workload: ${(scheduleData.totalHours / scheduleData.studyDays).toFixed(1)} hours/day<br>
             Total study time: ${scheduleData.totalHours} hours
        </div>
    `;
                scheduleList.appendChild(summaryItem);

                // Add study tips section
                if (currentAssignment) {
                    const tips = scheduler.generateStudyTips(currentAssignment);
                    if (tips.length > 0) {
                        const tipsSection = document.createElement('div');
                        tipsSection.className = 'schedule-item';
                        tipsSection.style.marginTop = '20px';
                        tipsSection.style.background = 'rgba(46, 204, 113, 0.05)';
                        tipsSection.innerHTML = `
                <div class="schedule-item-title"> Study Tips</div>
                <div class="schedule-item-desc">
                    <ul style="text-align: left; margin: 10px 0; padding-left: 20px;">
                        ${tips.map(tip => `<li>${tip}</li>`).join('')}
                    </ul>
                </div>
            `;
                        scheduleList.appendChild(tipsSection);
                    }
                }

                // Add balance suggestions if needed
                if (adjustments.length > 0) {
                    const balanceSection = document.createElement('div');
                    balanceSection.className = 'schedule-item';
                    balanceSection.style.marginTop = '20px';
                    balanceSection.style.background = 'rgba(243, 156, 18, 0.05)';

                    let balanceHTML = '<div class="schedule-item-title"> Balance Suggestions</div>';
                    balanceHTML += '<div class="schedule-item-desc">';
                    adjustments.forEach(adj => {
                        balanceHTML += ` ${adj.date}: ${adj.suggestion || adj.note}<br>`;
                    });
                    balanceHTML += '</div>';

                    balanceSection.innerHTML = balanceHTML;
                    scheduleList.appendChild(balanceSection);
                }

                scheduleModalSubtitle.innerHTML = `
        We've created a balanced study plan that prioritizes weekdays and avoids overloading:<br>
        <strong>${scheduleData.totalSessions} balanced sessions</strong> over <strong>${scheduleData.studyDays} study days</strong>, 
        totaling <strong>${scheduleData.totalHours} hours</strong>.
        ${scheduleData.daysUntilDue < 3 ? '<br><em> Due date is approaching soon! Starting immediately is recommended.</em>' : ''}
    `;

                scheduleModal.style.display = 'flex';
            }

            // Add schedule to calendar
            function addScheduleToCalendar(scheduleData) {
                scheduleData.schedule.forEach(session => {
                    const dateString = session.dateString;

                    // Determine session time (morning, afternoon, evening)
                    let time = '';
                    const hour = 9 + (session.priority === 'high' ? 0 : 3); // High priority = morning
                    const endHour = hour + session.length;
                    const ampmStart = hour >= 12 ? 'PM' : 'AM';
                    const ampmEnd = endHour >= 12 ? 'PM' : 'AM';
                    const displayHourStart = hour % 12 || 12;
                    const displayHourEnd = endHour % 12 || 12;

                    time = `${displayHourStart}:00 ${ampmStart} - ${displayHourEnd}:00 ${ampmEnd}`;

                    const event = {
                        id: calendarDB.generateEventId(),
                        time: time,
                        title: session.title,
                        subtitle: session.description,
                        type: 'study',
                        course: currentAssignment.course,
                        importance: getImportanceLevel(currentAssignment.importance),
                        difficulty: getDifficultyLevel(currentAssignment.difficulty),
                        assignmentId: currentAssignment.id,
                        assignmentTitle: currentAssignment.title,
                        priority: session.priority
                    };

                    calendarDB.saveEvent(dateString, event);
                });

                // Add the assignment due date event
                const dueDateString = currentAssignment.dueDate;
                let dueTime = 'All day';
                if (currentAssignment.dueTime) {
                    const [hours, minutes] = currentAssignment.dueTime.split(':');
                    let hour = parseInt(hours);
                    const ampm = hour >= 12 ? 'PM' : 'AM';
                    hour = hour % 12 || 12;
                    dueTime = `Due at ${hour}:${minutes} ${ampm}`;
                }

                const assignmentEvent = {
                    id: currentAssignment.id,
                    time: dueTime,
                    title: ` ${currentAssignment.title} DUE`,
                    subtitle: `${currentAssignment.course} - ${currentAssignment.description || 'Assignment due'}`,
                    type: 'assignment',
                    course: currentAssignment.course,
                    importance: getImportanceLevel(currentAssignment.importance),
                    difficulty: getDifficultyLevel(currentAssignment.difficulty)
                };

                calendarDB.saveEvent(dueDateString, assignmentEvent);

                // Update UI
                updateCalendar();
                updateTodaySection();
                updateUpcomingEvents();

                // Update calendar notifications with the new events
                updateCalendarNotifications();

                showFeedback(`Added ${scheduleData.totalSessions} study sessions and assignment to calendar!`, 'success');
                closeScheduleModal();
            }

            // Helper functions
            function getImportanceLevel(percentage) {
                if (percentage >= 30) return 'high';
                if (percentage >= 15) return 'medium';
                return 'low';
            }

            function getDifficultyLevel(level) {
                const levels = ['very easy', 'easy', 'medium', 'hard', 'very hard'];
                return levels[level - 1] || 'medium';
            }

            // Open Edit Modal
            function openEditModal(event, dateString) {
                selectedEventForEditing = { event, dateString };

                // Check if it's a regular event or assignment
                if (event.type === 'assignment' || event.type === 'exam' || event.type === 'study') {
                    addModalTitle.textContent = 'Edit Assignment';
                    openAddModal(true, event, dateString);
                } else {
                    addModalTitle.textContent = 'Edit Event';
                    openAddModal(false, event, dateString);
                }
            }

            // Open Delete Modal
            function openDeleteModal(event, dateString, mode = 'single') {
                selectedEventForDeletion = { event, dateString, mode };

                if (mode === 'single') {
                    deleteModalTitle.textContent = 'Delete Event';
                    deleteModalSubtitle.textContent = `Are you sure you want to delete "${event.title}"? This action cannot be undone.`;
                } else if (mode === 'all_today') {
                    deleteModalTitle.textContent = 'Delete All Today\'s Events';
                    deleteModalSubtitle.textContent = 'Are you sure you want to delete all events for today? This action cannot be undone.';
                } else if (mode === 'all_upcoming') {
                    deleteModalTitle.textContent = 'Delete All Upcoming Events';
                    deleteModalSubtitle.textContent = 'Are you sure you want to delete all upcoming events? This action cannot be undone.';
                } else if (mode === 'multiple') {
                    deleteModalTitle.textContent = 'Delete Selected Events';
                    deleteModalSubtitle.textContent = `Are you sure you want to delete ${selectedEvents.size} selected events? This action cannot be undone.`;
                }

                deleteModal.style.display = 'flex';
            }

            // Close Delete Modal
            function closeDeleteModal() {
                deleteModal.style.display = 'none';
                selectedEventForDeletion = null;
            }

            // Close Schedule Modal
            function closeScheduleModal() {
                scheduleModal.style.display = 'none';
                generatedSchedule = null;
                currentAssignment = null;
            }

            // Delete Event
            function deleteEvent() {
                if (!selectedEventForDeletion) return;

                const { event, dateString, mode } = selectedEventForDeletion;

                if (mode === 'single') {
                    // Delete single event
                    calendarDB.deleteEvent(dateString, event.id);
                    showFeedback(`Event "${event.title}" deleted successfully`, 'success');
                } else if (mode === 'all_today') {
                    // Delete all events for today
                    const today = new Date(2026, 1, 11);
                    const todayString = formatDate(today);
                    calendarDB.deleteAllEventsForDate(todayString);
                    showFeedback(`Deleted all events for today`, 'success');
                } else if (mode === 'all_upcoming') {
                    // Delete all upcoming events (next 14 days)
                    const today = new Date(2026, 1, 11);
                    const dateStrings = [];
                    for (let i = 0; i < 14; i++) {
                        const date = new Date(today);
                        date.setDate(today.getDate() + i);
                        dateStrings.push(formatDate(date));
                    }
                    calendarDB.deleteAllEventsForDates(dateStrings);
                    showFeedback(`Deleted all upcoming events`, 'success');
                } else if (mode === 'multiple') {
                    // Delete multiple selected events
                    let totalDeleted = 0;

                    selectedEvents.forEach(eventId => {
                        const [dateString, id] = eventId.split('_');
                        if (calendarDB.deleteEvent(dateString, id)) {
                            totalDeleted++;
                        }
                    });

                    showFeedback(`Deleted ${totalDeleted} selected events`, 'success');
                    disableSelectionMode();
                }

                // Update UI
                updateCalendar();
                updateTodaySection();
                updateUpcomingEvents();

                // Update calendar notifications after deletion
                updateCalendarNotifications();

                // Close modal
                closeDeleteModal();
            }

            // Selection Mode Functions
            function enableSelectionMode() {
                isSelectionMode = true;
                selectedEvents.clear();

                // Add selection mode styles
                document.querySelectorAll('.event-item').forEach(item => {
                    item.classList.add('selectable');
                });

                // Show selection header in today section
                const todayHeader = document.querySelector('.today-header');
                const selectionHeader = document.createElement('div');
                selectionHeader.className = 'selection-header';
                selectionHeader.innerHTML = `
                <div class="selection-count">0 selected</div>
                <div class="selection-actions">
                    <button class="selection-btn cancel" id="cancelSelection">
                        Cancel
                    </button>
                    <button class="selection-btn delete" id="deleteSelected">
                        Delete
                    </button>
                </div>
            `;

                // Insert selection header
                todayHeader.parentNode.insertBefore(selectionHeader, todayHeader.nextSibling);

                // Add event listeners for selection buttons
                document.getElementById('cancelSelection').addEventListener('click', disableSelectionMode);
                document.getElementById('deleteSelected').addEventListener('click', function () {
                    if (selectedEvents.size > 0) {
                        openDeleteModal(null, null, 'multiple');
                    }
                });

                showFeedback('Selection mode enabled. Tap events to select them.', 'info');
            }

            function disableSelectionMode() {
                isSelectionMode = false;
                selectedEvents.clear();

                // Remove selection mode styles
                document.querySelectorAll('.event-item').forEach(item => {
                    item.classList.remove('selected');
                    item.classList.remove('selectable');
                });

                // Remove selection header
                const selectionHeader = document.querySelector('.selection-header');
                if (selectionHeader) {
                    selectionHeader.remove();
                }

                showFeedback('Selection mode disabled', 'info');
            }

            function toggleEventSelection(eventId) {
                const dateString = document.querySelector(`[data-id="${eventId}"]`).dataset.date;
                const fullId = `${dateString}_${eventId}`;

                if (selectedEvents.has(fullId)) {
                    selectedEvents.delete(fullId);
                    document.querySelector(`[data-id="${eventId}"]`).classList.remove('selected');
                } else {
                    selectedEvents.add(fullId);
                    document.querySelector(`[data-id="${eventId}"]`).classList.add('selected');
                }

                // Update selection count
                const selectionCount = document.querySelector('.selection-count');
                if (selectionCount) {
                    selectionCount.textContent = `${selectedEvents.size} selected`;
                }
            }

            // Update Today Section
            function updateTodaySection() {
                const today = new Date(2026, 1, 11); // Fixed to February 11, 2026
                const dateString = formatDate(today);
                const events = calendarDB.getEventsForDate(dateString);

                todayDate.textContent = formatDateDisplay(today);

                // Clear current events
                todayEvents.innerHTML = '';

                if (events.length === 0) {
                    const noEvents = document.createElement('div');
                    noEvents.className = 'event-item';
                    noEvents.innerHTML = `
                    <div class="event-title">No events scheduled</div>
                    <div class="event-subtitle">Click "Add Event" to schedule something</div>
                `;
                    todayEvents.appendChild(noEvents);
                    deleteAllTodayBtn.style.display = 'none';
                } else {
                    events.forEach(event => {
                        const eventItem = createEventItem(event, dateString, false); // Don't show date for today's section
                        todayEvents.appendChild(eventItem);
                    });
                    deleteAllTodayBtn.style.display = 'flex';
                }
            }

            // Update Upcoming Events
            function updateUpcomingEvents() {
                // Get upcoming events from database
                const upcoming = calendarDB.getUpcomingEvents(14);

                // Clear current events
                upcomingEventsList.innerHTML = '';

                // Show up to 5 upcoming events
                const eventsToShow = upcoming.slice(0, 5);

                if (eventsToShow.length === 0) {
                    const noEvents = document.createElement('div');
                    noEvents.className = 'event-item';
                    noEvents.innerHTML = `
                    <div class="event-title">No upcoming events</div>
                    <div class="event-subtitle">Add events to see them here</div>
                `;
                    upcomingEventsList.appendChild(noEvents);
                    deleteAllUpcomingBtn.style.display = 'none';
                } else {
                    eventsToShow.forEach(eventData => {
                        // Pass true to showDate parameter for upcoming events
                        const eventItem = createEventItem(eventData, eventData.dateString, true);
                        upcomingEventsList.appendChild(eventItem);
                    });
                    deleteAllUpcomingBtn.style.display = 'flex';
                }
            }

            // Format Date as YYYY-MM-DD
            function formatDate(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }

            // Parse date string to Date object
            function parseDateFromString(dateString) {
                const [year, month, day] = dateString.split('-').map(Number);
                return new Date(year, month - 1, day);
            }

            // Format Date for Display
            function formatDateDisplay(date) {
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                    'July', 'August', 'September', 'October', 'November', 'December'];
                const month = monthNames[date.getMonth()];
                const day = date.getDate();
                return `${month} ${day}`;
            }

            // Show Feedback Message
            function showFeedback(message, type = 'info') {
                // Remove existing feedback
                const existingFeedback = document.querySelector('.feedback-message');
                if (existingFeedback) existingFeedback.remove();

                // Create feedback element
                const feedback = document.createElement('div');
                feedback.className = `feedback-message feedback-${type}`;
                feedback.style.cssText = `
                position: absolute;
                top: 120px;
                left: 50%;
                transform: translateX(-50%);
                background: ${type === 'error' ? 'rgba(231, 76, 60, 0.95)' :
                        type === 'success' ? 'rgba(46, 204, 113, 0.95)' :
                            type === 'info' ? 'rgba(52, 152, 219, 0.95)' :
                                'rgba(34, 96, 78, 0.95)'};
                color: white;
                padding: 12px 25px;
                border-radius: 25px;
                font-family: 'Nunito', sans-serif;
                font-weight: 600;
                font-size: 14px;
                z-index: 3000;
                animation: slideDown 0.3s ease;
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
                max-width: 80%;
                text-align: center;
                width: auto;
                margin-top: 50px;
            `;
                feedback.textContent = message;
                document.querySelector('.phone').appendChild(feedback);

                // Remove after 2 seconds
                setTimeout(() => {
                    feedback.style.animation = 'slideUp 0.3s ease forwards';
                    setTimeout(() => feedback.remove(), 300);
                }, 2000);
            }

            // Modal Functions
            function openGoogleModal() {
                googleModal.style.display = 'flex';
            }

            function closeGoogleModal() {
                googleModal.style.display = 'none';
            }

            function openAddModal(isAssignment = false, existingEvent = null, dateString = null) {
                selectedEventForEditing = existingEvent ? { event: existingEvent, dateString } : null;

                if (isAssignment) {
                    addModalTitle.textContent = existingEvent ? 'Edit Assignment' : 'Add New Assignment';
                    // Show assignment form
                    document.getElementById('addForm').innerHTML = `
                    <div class="form-group">
                        <label class="form-label" for="eventTitle">Assignment Title*</label>
                        <input type="text" id="eventTitle" class="form-input" placeholder="e.g., Math Homework Chapter 5" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="courseName">Course/Subject*</label>
                        <input type="text" id="courseName" class="form-input" placeholder="e.g., Calculus 101" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="eventDate">Due Date*</label>
                        <input type="date" id="eventDate" class="form-input" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="dueTime">Due Time (Optional)</label>
                        <input type="time" id="dueTime" class="form-input">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="importance">Importance (Weight/Percentage)*</label>
                        <div class="slider-container">
                            <input type="range" min="5" max="50" value="15" class="slider" id="importance">
                            <div class="slider-labels">
                                <span>5% (Low)</span>
                                <span>15%</span>
                                <span>30%</span>
                                <span>50% (High)</span>
                            </div>
                            <div class="slider-value" id="importanceValue">15% of final grade</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="difficulty">Course Difficulty*</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="5" value="3" class="slider" id="difficulty">
                            <div class="slider-labels">
                                <span>Very Easy</span>
                                <span>Easy</span>
                                <span>Medium</span>
                                <span>Hard</span>
                                <span>Very Hard</span>
                            </div>
                            <div class="slider-value" id="difficultyValue">Medium Difficulty</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="currentGrade">Current Grade in Course (Optional)</label>
                        <input type="number" id="currentGrade" class="form-input" placeholder="e.g., 85" min="0" max="100" step="0.1">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="targetGrade">Target Grade (Optional)</label>
                        <input type="number" id="targetGrade" class="form-input" placeholder="e.g., 90" min="0" max="100" step="0.1">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="estimatedHours">Estimated Hours to Complete*</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="20" value="5" class="slider" id="estimatedHours">
                            <div class="slider-labels">
                                <span>1 hour</span>
                                <span>5 hours</span>
                                <span>10 hours</span>
                                <span>15 hours</span>
                                <span>20+ hours</span>
                            </div>
                            <div class="slider-value" id="estimatedHoursValue">5 hours estimated</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="eventDescription">Description (Optional)</label>
                        <input type="text" id="eventDescription" class="form-input" placeholder="e.g., Problems 1-20, show all work">
                    </div>
                    
                    <div class="form-checkbox">
                        <input type="checkbox" id="autoSchedule" checked>
                        <label class="form-checkbox-label" for="autoSchedule">Automatically schedule study sessions</label>
                    </div>
                `;

                    // Set default date to selected date or today
                    let dateValue = '';
                    if (existingEvent && dateString) {
                        const [year, month, day] = dateString.split('-').map(Number);
                        dateValue = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    } else {
                        const selectedDate = document.querySelector('.day-cell.selected');
                        if (selectedDate) {
                            const day = selectedDate.querySelector('.day-number').textContent;
                            const month = calendarData.currentDate.getMonth() + 1;
                            const year = calendarData.currentDate.getFullYear();
                            dateValue = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                        } else {
                            const today = new Date(2026, 1, 11);
                            const futureDate = new Date(today);
                            futureDate.setDate(today.getDate() + 7); // Default to 1 week from today
                            dateValue = formatDate(futureDate);
                        }
                    }

                    // Fill form with existing event data if editing
                    if (existingEvent) {
                        document.getElementById('eventTitle').value = existingEvent.title.replace(' ', '').replace(' DUE', '');
                        document.getElementById('courseName').value = existingEvent.course || '';
                        document.getElementById('eventDate').value = dateValue;
                        document.getElementById('eventDescription').value = existingEvent.subtitle || '';

                        // Parse time if available
                        if (existingEvent.time !== 'All day' && !existingEvent.time.includes('Completed')) {
                            const timeMatch = existingEvent.time.match(/(\d{1,2}:\d{2})\s*[AP]M/);
                            if (timeMatch) {
                                let hours = timeMatch[1];
                                // Convert to 24-hour format
                                if (existingEvent.time.includes('PM') && !hours.startsWith('12')) {
                                    const [h, m] = hours.split(':');
                                    hours = `${parseInt(h) + 12}:${m}`;
                                } else if (existingEvent.time.includes('AM') && hours.startsWith('12')) {
                                    hours = `00:${hours.split(':')[1]}`;
                                }
                                document.getElementById('dueTime').value = hours;
                            }
                        }

                        // Set sliders based on event data
                        if (existingEvent.importance === 'high') document.getElementById('importance').value = 30;
                        else if (existingEvent.importance === 'medium') document.getElementById('importance').value = 15;
                        else document.getElementById('importance').value = 5;

                        if (existingEvent.difficulty === 'very hard') document.getElementById('difficulty').value = 5;
                        else if (existingEvent.difficulty === 'hard') document.getElementById('difficulty').value = 4;
                        else if (existingEvent.difficulty === 'medium') document.getElementById('difficulty').value = 3;
                        else if (existingEvent.difficulty === 'easy') document.getElementById('difficulty').value = 2;
                        else document.getElementById('difficulty').value = 1;

                        document.getElementById('estimatedHours').value = 5;

                        // Re-initialize sliders
                        initializeSliders();
                    } else {
                        // Set default values for new assignment
                        document.getElementById('eventDate').value = dateValue;
                        document.getElementById('dueTime').value = '23:59';
                        document.getElementById('currentGrade').value = '';
                        document.getElementById('targetGrade').value = '';
                        document.getElementById('eventDescription').value = '';

                        // Reset sliders to default values
                        document.getElementById('importance').value = 15;
                        document.getElementById('difficulty').value = 3;
                        document.getElementById('estimatedHours').value = 5;
                        document.getElementById('autoSchedule').checked = true;

                        // Re-initialize sliders
                        initializeSliders();
                    }
                } else {
                    // REGULAR EVENT - SIMPLE FORM
                    addModalTitle.textContent = existingEvent ? 'Edit Event' : 'Add New Event';
                    // Show simple event form
                    document.getElementById('addForm').innerHTML = `
                    <div class="form-group">
                        <label class="form-label" for="eventTitle">Event Title*</label>
                        <input type="text" id="eventTitle" class="form-input" placeholder="e.g., Team Meeting, Doctor Appointment" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="eventDate">Date*</label>
                        <input type="date" id="eventDate" class="form-input" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="eventDescription">Description (Optional)</label>
                        <input type="text" id="eventDescription" class="form-input" placeholder="e.g., Weekly team sync, Bring notes">
                    </div>
                `;

                    // Set default date to selected date or today
                    let dateValue = '';
                    if (existingEvent && dateString) {
                        const [year, month, day] = dateString.split('-').map(Number);
                        dateValue = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    } else {
                        const selectedDate = document.querySelector('.day-cell.selected');
                        if (selectedDate) {
                            const day = selectedDate.querySelector('.day-number').textContent;
                            const month = calendarData.currentDate.getMonth() + 1;
                            const year = calendarData.currentDate.getFullYear();
                            dateValue = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                        } else {
                            const today = new Date(2026, 1, 11);
                            const futureDate = new Date(today);
                            futureDate.setDate(today.getDate() + 7); // Default to 1 week from today
                            dateValue = formatDate(futureDate);
                        }
                    }

                    // Fill form with existing event data if editing
                    if (existingEvent) {
                        document.getElementById('eventTitle').value = existingEvent.title;
                        document.getElementById('eventDate').value = dateValue;
                        document.getElementById('eventDescription').value = existingEvent.subtitle || '';
                    } else {
                        // Set default values for new event
                        document.getElementById('eventTitle').value = '';
                        document.getElementById('eventDate').value = dateValue;
                        document.getElementById('eventDescription').value = '';
                    }
                }

                addEventModal.style.display = 'flex';
            }

            function closeAddModal() {
                addEventModal.style.display = 'none';
                addEventModal.style.opacity = '0';
                addEventModal.style.visibility = 'hidden';
                selectedEventForEditing = null;
            }

            // Initialize sliders for assignment form
            function initializeSliders() {
                const importanceSlider = document.getElementById('importance');
                const importanceValue = document.getElementById('importanceValue');
                const difficultySlider = document.getElementById('difficulty');
                const difficultyValue = document.getElementById('difficultyValue');
                const estimatedHoursSlider = document.getElementById('estimatedHours');
                const estimatedHoursValue = document.getElementById('estimatedHoursValue');

                if (importanceSlider && importanceValue) {
                    importanceSlider.addEventListener('input', function () {
                        const importance = parseInt(this.value);
                        importanceValue.textContent = `${importance}% of final grade`;
                    });
                }

                if (difficultySlider && difficultyValue) {
                    difficultySlider.addEventListener('input', function () {
                        const difficulty = parseInt(this.value);
                        const difficultyLabels = ['Very Easy', 'Easy', 'Medium', 'Hard', 'Very Hard'];
                        difficultyValue.textContent = `${difficultyLabels[difficulty - 1]} Difficulty`;
                    });
                }

                if (estimatedHoursSlider && estimatedHoursValue) {
                    estimatedHoursSlider.addEventListener('input', function () {
                        const hours = parseInt(this.value);
                        estimatedHoursValue.textContent = `${hours} ${hours === 1 ? 'hour' : 'hours'} estimated`;
                    });
                }
            }

            // Save Assignment with AI scheduling
            function saveAssignment() {
                // Get form values
                const title = document.getElementById('eventTitle').value;
                const course = document.getElementById('courseName').value;
                const dueDate = document.getElementById('eventDate').value;
                const dueTime = document.getElementById('dueTime').value;
                const importance = parseInt(document.getElementById('importance').value);
                const difficulty = parseInt(document.getElementById('difficulty').value);
                const currentGrade = document.getElementById('currentGrade').value;
                const targetGrade = document.getElementById('targetGrade').value;
                const estimatedHours = parseInt(document.getElementById('estimatedHours').value);
                const description = document.getElementById('eventDescription').value;
                const autoSchedule = document.getElementById('autoSchedule').checked;

                // Validation
                if (!title || !course || !dueDate) {
                    showFeedback('Please fill in all required fields', 'error');
                    return;
                }

                // Check if due date is in the past
                const today = new Date(2026, 1, 11);
                const due = parseDateFromString(dueDate);
                if (due < today) {
                    showFeedback('Due date cannot be in the past', 'error');
                    return;
                }

                // Create assignment object
                currentAssignment = {
                    id: selectedEventForEditing ? selectedEventForEditing.event.id : calendarDB.generateEventId(),
                    title: title,
                    course: course,
                    dueDate: dueDate,
                    dueTime: dueTime,
                    importance: importance,
                    difficulty: difficulty,
                    currentGrade: currentGrade ? parseFloat(currentGrade) : null,
                    targetGrade: targetGrade ? parseFloat(targetGrade) : null,
                    estimatedHours: estimatedHours,
                    description: description
                };

                if (autoSchedule) {
                    // Generate and display schedule
                    generatedSchedule = generateStudySchedule(currentAssignment);
                    if (generatedSchedule) {
                        // Close the add modal first
                        closeAddModal();
                        // Then show the schedule modal after a brief delay
                        setTimeout(() => {
                            displaySchedule(generatedSchedule);
                        }, 300);
                    } else {
                        showFeedback('Failed to generate schedule. Please check your assignment details.', 'error');
                    }
                } else {
                    // Just add the assignment without study sessions
                    const dueDateString = dueDate;
                    let dueTimeText = 'All day';
                    if (dueTime) {
                        const [hours, minutes] = dueTime.split(':');
                        let hour = parseInt(hours);
                        const ampm = hour >= 12 ? 'PM' : 'AM';
                        hour = hour % 12 || 12;
                        dueTimeText = `Due at ${hour}:${minutes} ${ampm}`;
                    }

                    const assignmentEvent = {
                        id: currentAssignment.id,
                        time: dueTimeText,
                        title: ` ${title} DUE`,
                        subtitle: `${course} - ${description || 'Assignment due'}`,
                        type: 'assignment',
                        course: course,
                        importance: getImportanceLevel(importance),
                        difficulty: getDifficultyLevel(difficulty)
                    };

                    // If editing, delete old event first
                    if (selectedEventForEditing) {
                        calendarDB.deleteEvent(selectedEventForEditing.dateString, selectedEventForEditing.event.id);
                    }

                    calendarDB.saveEvent(dueDateString, assignmentEvent);

                    // Update UI
                    updateCalendar();
                    updateTodaySection();
                    updateUpcomingEvents();

                    // Update calendar notifications with the new event
                    updateCalendarNotifications();

                    showFeedback(`Assignment "${title}" ${selectedEventForEditing ? 'updated' : 'added'} to calendar!`, 'success');
                    closeAddModal();
                }
            }

            // Save regular event
            function saveEvent() {
                // This is for regular events (non-assignments)
                const title = document.getElementById('eventTitle').value;
                const date = document.getElementById('eventDate').value;
                const description = document.getElementById('eventDescription').value;

                if (!title || !date) {
                    showFeedback('Please fill in all required fields', 'error');
                    return;
                }

                // Parse date
                const eventDate = parseDateFromString(date);
                const dateString = formatDate(eventDate);

                // Create event object
                const newEvent = {
                    id: selectedEventForEditing ? selectedEventForEditing.event.id : calendarDB.generateEventId(),
                    time: 'All day',
                    title: title,
                    subtitle: description || 'Event',
                    type: 'event'
                };

                // If editing, delete old event first
                if (selectedEventForEditing) {
                    calendarDB.deleteEvent(selectedEventForEditing.dateString, selectedEventForEditing.event.id);
                }

                // Add to database
                calendarDB.saveEvent(dateString, newEvent);

                // Update calendar
                updateCalendar();
                updateTodaySection();
                updateUpcomingEvents();

                // Update calendar notifications with the new event
                updateCalendarNotifications();

                showFeedback(`Event "${title}" ${selectedEventForEditing ? 'updated' : 'added'} successfully!`, 'success');

                // Close modal
                closeAddModal();
            }

            // Google Integration
            function connectToGoogle() {
                showFeedback('Connecting to Google...', 'info');

                // Simulate connection process
                setTimeout(() => {
                    showFeedback('Successfully connected to Google Calendar!', 'success');
                    closeGoogleModal();

                    // Simulate importing events
                    setTimeout(() => {
                        // Add some sample Google events
                        const sampleEvents = [
                            {
                                id: calendarDB.generateEventId(),
                                date: '2026-02-14',
                                time: 'All day',
                                title: 'Valentine\'s Day',
                                subtitle: 'Google Calendar',
                                type: 'event'
                            },
                            {
                                id: calendarDB.generateEventId(),
                                date: '2026-02-16',
                                time: '10:00 AM - 11:00 AM',
                                title: 'Team Meeting',
                                subtitle: 'Google Calendar',
                                type: 'meeting'
                            }
                        ];

                        sampleEvents.forEach(event => {
                            const dateString = event.date;
                            delete event.date;

                            calendarDB.saveEvent(dateString, event);
                        });

                        updateCalendar();
                        updateUpcomingEvents();

                        // Update calendar notifications with the new imported events
                        updateCalendarNotifications();

                        showFeedback('Imported events from Google Calendar', 'success');
                    }, 1000);
                }, 1500);
            }

            function connectToICal() {
                showFeedback('iCal integration coming soon!', 'info');
                closeGoogleModal();
            }

            // Event Listeners
            // Modal buttons
            addAssignmentBtn.addEventListener('click', function (e) {
                e.preventDefault();
                openAddModal(true);
            });

            addEventBtn.addEventListener('click', function (e) {
                e.preventDefault();
                openAddModal(false);
            });

            manageEventsBtn.addEventListener('click', function (e) {
                e.preventDefault();
                enableSelectionMode();
            });

            googleIntegrationBtn.addEventListener('click', function (e) {
                e.preventDefault();
                openGoogleModal();
            });

            viewItineraryBtn.addEventListener('click', function (e) {
                e.preventDefault();
                // Scroll to today's section
                document.querySelector('.today-section').scrollIntoView({ behavior: 'smooth' });
                showFeedback('Showing today\'s itinerary', 'info');
            });

            // Delete All buttons
            deleteAllTodayBtn.addEventListener('click', function () {
                openDeleteModal(null, null, 'all_today');
            });

            deleteAllUpcomingBtn.addEventListener('click', function () {
                openDeleteModal(null, null, 'all_upcoming');
            });

            // Today button event listener
            todayBtn.addEventListener('click', function () {
                // Set current date to today
                calendarData.currentDate = new Date(2026, 1, 11); // February 11, 2026

                // Update calendar
                updateCalendar();

                // Select today
                selectDay(calendarData.currentDate);

                // Show feedback
                showFeedback('Returned to today', 'info');
            });

            // Modal button listeners
            cancelGoogle.addEventListener('click', closeGoogleModal);
            connectGoogle.addEventListener('click', connectToGoogle);
            cancelAdd.addEventListener('click', closeAddModal);
            saveAdd.addEventListener('click', function (e) {
                e.preventDefault(); // Prevent form submission
                if (addModalTitle.textContent.includes('Assignment')) {
                    saveAssignment();
                } else {
                    saveEvent();
                }
            });
            cancelDelete.addEventListener('click', closeDeleteModal);
            confirmDelete.addEventListener('click', deleteEvent);
            cancelSchedule.addEventListener('click', closeScheduleModal);
            confirmSchedule.addEventListener('click', function () {
                if (generatedSchedule && currentAssignment) {
                    addScheduleToCalendar(generatedSchedule);
                }
            });

            googleConnect.addEventListener('click', function () {
                document.querySelectorAll('.integration-option').forEach(opt => {
                    opt.style.borderColor = 'rgba(34, 96, 78, 0.1)';
                });
                this.style.borderColor = '#22604e';
                connectGoogle.textContent = 'Connect with Google';
                connectGoogle.onclick = connectToGoogle;
            });

            iCalConnect.addEventListener('click', function () {
                document.querySelectorAll('.integration-option').forEach(opt => {
                    opt.style.borderColor = 'rgba(34, 96, 78, 0.1)';
                });
                this.style.borderColor = '#22604e';
                connectGoogle.textContent = 'Import iCal';
                connectGoogle.onclick = connectToICal;
            });

            // Calendar navigation
            prevMonthBtn.addEventListener('click', function () {
                calendarData.currentDate.setMonth(calendarData.currentDate.getMonth() - 1);
                updateCalendar();
            });

            nextMonthBtn.addEventListener('click', function () {
                calendarData.currentDate.setMonth(calendarData.currentDate.getMonth() + 1);
                updateCalendar();
            });

            // Close modals when clicking outside
            window.addEventListener('click', function (e) {
                if (e.target === googleModal) {
                    closeGoogleModal();
                }
                if (e.target === addEventModal) {
                    closeAddModal();
                }
                if (e.target === deleteModal) {
                    closeDeleteModal();
                }
                if (e.target === scheduleModal) {
                    closeScheduleModal();
                }
            });

            // Navigation
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function (e) {
                    // Remove active class from all
                    navItems.forEach(nav => nav.classList.remove('active'));

                    const href = this.getAttribute('href');
                    if (href && href !== '#') {
                        setTimeout(() => {
                            window.location.href = href;
                        }, 300);
                    }
                });
            });

            // Update notification badge when page becomes visible
            document.addEventListener('visibilitychange', function () {
                if (!document.hidden) {
                    const updatedUser = userDB.getCurrentUser();
                    if (updatedUser) {
                        currentUser.notifications = updatedUser.notifications;
                        updateNotificationBadge();
                    }
                }
            });

            // Initialize with sample data if empty
            function initializeSampleData() {
                const events = calendarDB.getAllEvents();
                if (Object.keys(events).length === 0) {
                    // Add sample events
                    const sampleEvents = {
                        '2026-02-11': [
                            {
                                id: 'event_1',
                                time: '4:00 PM - 5:00 PM',
                                title: 'Study for English Test',
                                subtitle: 'Review chapters 5-7',
                                type: 'study',
                                course: 'English Literature',
                                importance: 'high',
                                difficulty: 'medium'
                            },
                            {
                                id: 'event_2',
                                time: '6:00 PM - 8:00 PM',
                                title: 'Practice Math',
                                subtitle: 'Algebra problems set',
                                type: 'study',
                                course: 'Mathematics',
                                importance: 'medium',
                                difficulty: 'hard'
                            }
                        ],
                        '2026-02-12': [
                            {
                                id: 'event_3',
                                time: 'All day',
                                title: 'Math Exam',
                                subtitle: 'Room 204, 9:00 AM',
                                type: 'exam',
                                course: 'Calculus 101',
                                importance: 'high',
                                difficulty: 'very hard'
                            },
                            {
                                id: 'event_4',
                                time: 'All day',
                                title: 'History Essay Due',
                                subtitle: 'Submit online by 11:59 PM',
                                type: 'assignment',
                                course: 'World History',
                                importance: 'medium',
                                difficulty: 'medium'
                            }
                        ]
                    };

                    for (const dateString in sampleEvents) {
                        sampleEvents[dateString].forEach(event => {
                            calendarDB.saveEvent(dateString, event);
                        });
                    }
                }
            }

            // Initialize
            initializeSampleData();
            initCalendar();

            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
            @keyframes slideDown {
                from { top: 80px; opacity: 0; }
                to { top: 120px; opacity: 1; }
            }
            
            @keyframes slideUp {
                from { top: 120px; opacity: 1; }
                to { top: 80px; opacity: 0; }
            }
            
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
            
            .fade-in {
                animation: fadeIn 0.5s ease forwards;
                opacity: 0;
            }

            /* Ensure nav badge is completely hidden when empty */
            .nav-badge:empty,
            .nav-badge.hidden {
                display: none !important;
                visibility: hidden !important;
                opacity: 0 !important;
                background: none !important;
                box-shadow: none !important;
                transform: scale(0) !important;
            }

            /* Event date styling */
            .event-date {
                font-family: 'Nunito', sans-serif;
                font-size: 14px;
                font-weight: 700;
                padding: 4px 10px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 12px;
                border: 1px solid rgba(34, 96, 78, 0.2);
            }

            .event-item:hover .event-date {
                background: rgba(255, 255, 255, 0.3);
            }

            /* Single red dot in center */
            .event-indicator {
                width: 8px;
                height: 8px;
                background: #ff6b6b;
                border-radius: 50%;
                position: absolute;
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
            }
        `;
            document.head.appendChild(style);

            // Force hide badge on load to ensure it starts at correct state
            setTimeout(() => {
                updateNotificationBadge();
            }, 100);
        });
    </script>
</body>

</html>